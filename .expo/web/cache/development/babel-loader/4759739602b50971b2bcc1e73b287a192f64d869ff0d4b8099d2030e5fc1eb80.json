{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.validatorSignIn = validatorSignIn;\nexports.validatorRegister = validatorRegister;\nexports.validatorLoginMobile = validatorLoginMobile;\nexports.validatorForgotPassword = validatorForgotPassword;\nexports.validatorChangePassword = validatorChangePassword;\nexports.validatorUpdateAccount = validatorUpdateAccount;\nvar _immutable = require(\"immutable\");\nvar _isEmail = _interopRequireDefault(require(\"validator/lib/isEmail\"));\nvar _isLength = _interopRequireDefault(require(\"validator/lib/isLength\"));\nvar _isMobilePhone = _interopRequireDefault(require(\"validator/lib/isMobilePhone\"));\nvar _isAlphanumeric = _interopRequireDefault(require(\"validator/lib/isAlphanumeric\"));\nvar _passwordValidator = _interopRequireDefault(require(\"password-validator\"));\nvar _en = _interopRequireDefault(require(\"/home/ahmed/Music/softtag/Source Code/src/locales/en.json\"));\nvar _ar = _interopRequireDefault(require(\"/home/ahmed/Music/softtag/Source Code/src/locales/ar.json\"));\nvar schema = new _passwordValidator.default();\nschema.is().min(6).is().max(20).has().digits().has().not().spaces();\nvar languages = {\n  en: _en.default,\n  ar: _ar.default\n};\nfunction validatorSignIn(data, language) {\n  var errors = (0, _immutable.Map)();\n  var t = languages[language] ? languages[language] : languages.en;\n  var validators = t.validators || {};\n  if (!data || !data.username || !((0, _isEmail.default)(data.username) || (0, _isAlphanumeric.default)(data.username) && (0, _isLength.default)(data.username, {\n    min: 6,\n    max: 20\n  }))) {\n    errors = errors.set('username', validators.text_user_email);\n  }\n  if (!data || !data.password || !schema.validate(data.password)) {\n    errors = errors.set('password', validators.text_password);\n  }\n  return errors;\n}\nfunction validatorRegister(register) {\n  var isPhone = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n  var language = arguments.length > 2 ? arguments[2] : undefined;\n  var t = languages[language] ? languages[language] : languages.en;\n  var validators = t.validators || {};\n  var errors = (0, _immutable.Map)();\n  if (!register || !register.first_name || !(0, _isLength.default)(register.first_name, {\n    min: 1,\n    max: 32\n  })) {\n    errors = errors.set('first_name', validators.text_first_name);\n  }\n  if (!register || !register.last_name || !(0, _isLength.default)(register.last_name, {\n    min: 1,\n    max: 32\n  })) {\n    errors = errors.set('last_name', validators.text_last_name);\n  }\n  if (!register || !register.name || !(0, _isAlphanumeric.default)(register.name) || !(0, _isLength.default)(register.name, {\n    min: 6,\n    max: 20\n  })) {\n    errors = errors.set('name', validators.text_username);\n  }\n  if (isPhone) {\n    if (!register || !register.phone_number) {\n      errors = errors.set('phone_number', validators.text_phone);\n    }\n  }\n  if (!register || !register.email || !(0, _isEmail.default)(register.email)) {\n    errors = errors.set('email', validators.text_email);\n  }\n  if (!register || !register.password || !schema.validate(register.password)) {\n    errors = errors.set('password', validators.text_password);\n  }\n  return errors;\n}\nfunction validatorLoginMobile(phone, language) {\n  var t = languages[language] ? languages[language] : languages.en;\n  var validators = t.validators || {};\n  var errors = (0, _immutable.Map)();\n  if (!phone || !(0, _isMobilePhone.default)(phone, undefined, {\n    strictMode: true\n  })) {\n    errors = errors.set('phone_number', validators.text_phone);\n  }\n  return errors;\n}\nfunction validatorForgotPassword(email, language) {\n  var t = languages[language] ? languages[language] : languages.en;\n  var validators = t.validators || {};\n  var errors = (0, _immutable.Map)();\n  if (!email || !(0, _isEmail.default)(email)) {\n    errors = errors.set('email', validators.text_email);\n  }\n  return errors;\n}\nfunction validatorChangePassword(data, language) {\n  var t = languages[language] ? languages[language] : languages.en;\n  var validators = t.validators || {};\n  var errors = (0, _immutable.Map)();\n  if (!data || !data.password_old) {\n    errors = errors.set('password_old', validators.text_password_old);\n  }\n  if (!data || !data.password_new || !schema.validate(data.password_new)) {\n    errors = errors.set('password_new', validators.text_password);\n  }\n  if (!data || !data.password_confirm || data.password_confirm !== data.password_new) {\n    errors = errors.set('password_confirm', validators.text_password_confirm);\n  }\n  return errors;\n}\nfunction validatorUpdateAccount(data, language) {\n  var errors = (0, _immutable.Map)();\n  var t = languages[language] ? languages[language] : languages.en;\n  var validators = t.validators || {};\n  if (!data || !data.first_name || !(0, _isLength.default)(data.first_name, {\n    min: 1,\n    max: 32\n  })) {\n    errors = errors.set('first_name', validators.text_first_name);\n  }\n  if (!data || !data.last_name || !(0, _isLength.default)(data.last_name, {\n    min: 1,\n    max: 32\n  })) {\n    errors = errors.set('last_name', validators.text_last_name);\n  }\n  if (!data || !data.email || !(0, _isEmail.default)(data.email)) {\n    errors = errors.set('email', validators.text_email);\n  }\n  return errors;\n}","map":{"version":3,"names":["_immutable","require","_isEmail","_interopRequireDefault","_isLength","_isMobilePhone","_isAlphanumeric","_passwordValidator","_en","_ar","schema","passwordValidator","is","min","max","has","digits","not","spaces","languages","en","ar","validatorSignIn","data","language","errors","Map","t","validators","username","isEmail","isAlphanumeric","isLength","set","text_user_email","password","validate","text_password","validatorRegister","register","isPhone","arguments","length","undefined","first_name","text_first_name","last_name","text_last_name","name","text_username","phone_number","text_phone","email","text_email","validatorLoginMobile","phone","isMobilePhone","strictMode","validatorForgotPassword","validatorChangePassword","password_old","text_password_old","password_new","password_confirm","text_password_confirm","validatorUpdateAccount"],"sources":["/home/ahmed/Music/softtag/Source Code/src/modules/auth/validator.js"],"sourcesContent":["import {Map} from 'immutable';\nimport isEmail from 'validator/lib/isEmail';\nimport isLength from 'validator/lib/isLength';\nimport isMobilePhone from 'validator/lib/isMobilePhone';\nimport isAlphanumeric from 'validator/lib/isAlphanumeric';\nimport passwordValidator from 'password-validator';\n\nimport en from 'src/locales/en.json';\nimport ar from 'src/locales/ar.json';\n\nlet schema = new passwordValidator();\n\nschema\n  .is()\n  .min(6) // Minimum length 6\n  .is()\n  .max(20) // Maximum length 20\n  .has()\n  .digits() // Must have digits\n  .has()\n  .not()\n  .spaces(); // Should not have spaces\n\nconst languages = {\n  en,\n  ar,\n};\n\nexport function validatorSignIn(data, language) {\n  let errors = Map();\n  const t = languages[language] ? languages[language] : languages.en;\n  const validators = t.validators || {};\n\n  if (\n    !data ||\n    !data.username ||\n    !(\n      isEmail(data.username) ||\n      (isAlphanumeric(data.username) &&\n        isLength(data.username, {min: 6, max: 20}))\n    )\n  ) {\n    errors = errors.set('username', validators.text_user_email);\n  }\n\n  if (!data || !data.password || !schema.validate(data.password)) {\n    errors = errors.set('password', validators.text_password);\n  }\n\n  return errors;\n}\n\nexport function validatorRegister(register, isPhone = true, language) {\n  const t = languages[language] ? languages[language] : languages.en;\n  const validators = t.validators || {};\n\n  let errors = Map();\n\n  if (\n    !register ||\n    !register.first_name ||\n    !isLength(register.first_name, {min: 1, max: 32})\n  ) {\n    errors = errors.set('first_name', validators.text_first_name);\n  }\n\n  if (\n    !register ||\n    !register.last_name ||\n    !isLength(register.last_name, {min: 1, max: 32})\n  ) {\n    errors = errors.set('last_name', validators.text_last_name);\n  }\n\n  if (\n    !register ||\n    !register.name ||\n    !isAlphanumeric(register.name) ||\n    !isLength(register.name, {min: 6, max: 20})\n  ) {\n    errors = errors.set('name', validators.text_username);\n  }\n\n  if (isPhone) {\n    if (!register || !register.phone_number) {\n      errors = errors.set('phone_number', validators.text_phone);\n    }\n  }\n\n  if (!register || !register.email || !isEmail(register.email)) {\n    errors = errors.set('email', validators.text_email);\n  }\n\n  if (!register || !register.password || !schema.validate(register.password)) {\n    errors = errors.set('password', validators.text_password);\n  }\n\n  return errors;\n}\n\nexport function validatorLoginMobile(phone, language) {\n  const t = languages[language] ? languages[language] : languages.en;\n  const validators = t.validators || {};\n\n  let errors = Map();\n\n  if (!phone || !isMobilePhone(phone, undefined, {strictMode: true})) {\n    errors = errors.set('phone_number', validators.text_phone);\n  }\n\n  return errors;\n}\n\nexport function validatorForgotPassword(email, language) {\n  const t = languages[language] ? languages[language] : languages.en;\n  const validators = t.validators || {};\n\n  let errors = Map();\n\n  if (!email || !isEmail(email)) {\n    errors = errors.set('email', validators.text_email);\n  }\n\n  return errors;\n}\n\nexport function validatorChangePassword(data, language) {\n  const t = languages[language] ? languages[language] : languages.en;\n  const validators = t.validators || {};\n\n  let errors = Map();\n\n  if (!data || !data.password_old) {\n    errors = errors.set('password_old', validators.text_password_old);\n  }\n\n  if (!data || !data.password_new || !schema.validate(data.password_new)) {\n    errors = errors.set('password_new', validators.text_password);\n  }\n\n  if (\n    !data ||\n    !data.password_confirm ||\n    data.password_confirm !== data.password_new\n  ) {\n    errors = errors.set('password_confirm', validators.text_password_confirm);\n  }\n\n  return errors;\n}\n\nexport function validatorUpdateAccount(data, language) {\n  let errors = Map();\n  const t = languages[language] ? languages[language] : languages.en;\n  const validators = t.validators || {};\n\n  if (\n    !data ||\n    !data.first_name ||\n    !isLength(data.first_name, {min: 1, max: 32})\n  ) {\n    errors = errors.set('first_name', validators.text_first_name);\n  }\n\n  if (\n    !data ||\n    !data.last_name ||\n    !isLength(data.last_name, {min: 1, max: 32})\n  ) {\n    errors = errors.set('last_name', validators.text_last_name);\n  }\n\n  // if (\n  //   !data ||\n  //   !data.last_name ||\n  //   !isLength(data.last_name, {min: 1, max: 32})\n  // ) {\n  //   errors = errors.set('last_name', validators.text_last_name);\n  // }\n\n  if (!data || !data.email || !isEmail(data.email)) {\n    errors = errors.set('email', validators.text_email);\n  }\n\n  return errors;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}